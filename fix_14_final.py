import json
import sys
import io
import re

# UTF-8 인코딩 강제 설정
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')

with open('today_unse/stories/14_병인.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# 본문 내용을 읽고 그에 맞는 액션 작성 (본문 보완·강조)
# 병인: 열정, 창의성, 희망, 생명력, 인간 비타민

custom_actions = {
    # 장생
    ("장생", 1): "시작하세요. 시원하게 사람들에게 다가가, 좋은 반응을 얻으며 솔직하게 즐기세요.",
    ("장생", 2): "행동하세요. 생동감 있게 에너지를 발산해, 함께하고 싶은 사람이 되세요.",
    ("장생", 3): "감사하세요. 명랑하게 다가가 받은 후원에, 순수한 마음으로 감사를 전하세요.",
    ("장생", 4): "밀어붙이세요. 밝은 에너지로 솔직하게 표현하며, 응원받는 사람이 되세요.",
    ("장생", 5): "회복하세요. 밝게 긍정 에너지를 받아들여, 창의적 지혜로 빠르게 활력을 찾으세요.",
    ("장생", 6): "소통하세요. 적극적으로 매력을 어필하며, 생동감 있고 자신감 있게 연결되세요.",
    ("장생", 7): "성장하세요. 열정적 태도를 믿고 꾸준히 나아가, 상냥하게 과정을 즐기며 결실을 맺으세요.",
    ("장생", 8): "받으세요. 천우신조의 축복을 감사히 받아들이며, 귀인의 도움으로 빛나세요.",
    ("장생", 9): "몰아내세요. 아침 해처럼 어둠을 몰아내며, 만물에 생명력을 불어넣으세요.",
    ("장생", 10): "솟아오르세요. 목화통명으로 창의적 지혜를 발휘하며, 무한한 아이디어를 펼치세요.",

    # 목욕
    ("목욕", 1): "음미하세요. 예민해진 오감으로 아름다움을 경험하며, 긍정적으로 순간을 즐기세요.",
    ("목욕", 2): "발산하세요. 상냥하게 다가가 매력을 최고조로 드러내며, 독창적으로 빛나세요.",
    ("목욕", 3): "시도하세요. 밝은 에너지로 새로운 선택을 해, 시원시원하게 신선한 자극을 받으세요.",
    ("목욕", 4): "조절하세요. 감정 기복을 순수하게 느끼되 과하지 않게, 집중력으로 균형을 잡으세요.",
    ("목욕", 5): "돌보세요. 초연한 자세로 나만의 방식으로, 진솔하게 자신에게 집중하세요.",
    ("목욕", 6): "주목하세요. 예민한 직관으로 판단해, 정확한 통찰을 얻으세요.",
    ("목욕", 7): "전달하세요. 진솔하고 우아한 표현력으로, 부드럽게 품격을 유지하며 감탄받으세요.",
    ("목욕", 8): "조화시키세요. 감정 기복을 밝은 에너지로 바꾸며, 햇살처럼 긍정적으로 드러내세요.",
    ("목욕", 9): "즐기세요. 화려한 순간을 열정적으로 누리며, 활기차게 빛내세요.",
    ("목욕", 10): "지키세요. 순수함을 소중히 여기며, 밝게 유지하세요.",

    # 관대
    ("관대", 1): "성장하세요. 열정을 담아 도전을 받아들이며, 한 단계씩 차근히 올라가세요.",
    ("관대", 2): "준비하세요. 창의적으로 계획을 세우고, 완벽히 마무리하세요.",
    ("관대", 3): "완수하세요. 성실하게 맡은 일을 해내, 밝은 에너지로 신뢰를 얻으세요.",
    ("관대", 4): "나누세요. 인정받는 순간을 솔직하게 받아들이며, 기쁨을 나누고 더 나아가세요.",
    ("관대", 5): "자립하세요. 독립적으로 판단하고 행동해, 열정적으로 자유를 얻으세요.",
    ("관대", 6): "발휘하세요. 갈고닦은 실력을 자신 있게 보여주며, 활약하세요.",
    ("관대", 7): "확립하세요. 꾸준히 노력해 자리를 단단히 다지며, 빛을 발하세요.",
    ("관대", 8): "인정받으세요. 능력을 창의적으로 발휘하며, 존경을 얻으세요.",
    ("관대", 9): "나아가세요. 열정을 불태우며 앞으로, 힘차게 전진하세요.",
    ("관대", 10): "완성하세요. 준비를 마무리하며, 자신 있게 도약하세요.",

    # 건록
    ("건록", 1): "유지하세요. 안정을 꾸준히 지키며, 밝게 나아가세요.",
    ("건록", 2): "발휘하세요. 실력을 열정적으로, 확실히 보여주세요.",
    ("건록", 3): "해결하세요. 스스로 해결하는 힘을 긍정적으로, 키우세요.",
    ("건록", 4): "거두세요. 노력의 결실을 기쁘게, 활짝 누리세요.",
    ("건록", 5): "균형잡으세요. 일과 휴식의 조화를 슬기롭게, 맞춰가세요.",
    ("건록", 6): "인정받으세요. 전문성을 성실히 쌓아, 빛을 발하세요.",
    ("건록", 7): "다지세요. 기반을 차근차근, 튼튼히 쌓아가세요.",
    ("건록", 8): "집중하세요. 열정을 쏟아 일에, 몰입하세요.",
    ("건록", 9): "유지하세요. 꾸준함으로 안정을, 활기차게 지켜가세요.",
    ("건록", 10): "완성하세요. 성실함으로 실력을, 완벽히 갖추세요.",

    # 제왕
    ("제왕", 1): "누리세요. 최고의 순간을 밝게, 당당히 만끽하세요.",
    ("제왕", 2): "이끄세요. 리더십을 발휘해 사람들을, 열정적으로 인도하세요.",
    ("제왕", 3): "빛나세요. 완벽한 컨디션으로 오늘을, 최고로 빛내세요.",
    ("제왕", 4): "확대하세요. 영향력을 활기차게, 넓게 펼치세요.",
    ("제왕", 5): "만끽하세요. 성취를 기쁘게 누리며, 환하게 나누세요.",
    ("제왕", 6): "드러내세요. 자신감을 밝게, 당당하게 표현하세요.",
    ("제왕", 7): "감동시키세요. 카리스마를 발산하며 사람들을, 열정으로 이끄세요.",
    ("제왕", 8): "실현하세요. 창의적 비전을 현실로, 멋지게 만드세요.",
    ("제왕", 9): "주도하세요. 열정으로 상황을, 활기차게 이끌어가세요.",
    ("제왕", 10): "완성하세요. 희망찬 비전을 밝게, 완벽히 이루세요.",

    # 쇠
    ("쇠", 1): "여유부리세요. 느긋한 마음으로 하루를, 평온하게 보내세요.",
    ("쇠", 2): "사색하세요. 지혜를 깊이 생각하며, 통찰을 얻으세요.",
    ("쇠", 3): "안정하세요. 평온함을 차분히 추구하며, 중심을 잡으세요.",
    ("쇠", 4): "활용하세요. 노련한 지혜를 슬기롭게, 활용하세요.",
    ("쇠", 5): "챙기세요. 실속을 똑똑하게, 꼼꼼히 챙기세요.",
    ("쇠", 6): "지키세요. 신념을 은근히 고집하며, 흔들리지 마세요.",
    ("쇠", 7): "쉬세요. 충분히 휴식하며 에너지를, 재충전하세요.",
    ("쇠", 8): "숙고하세요. 깊이 생각하며 지혜를, 키워가세요.",
    ("쇠", 9): "유지하세요. 평온함 속에서 안정을, 꾸준히 지키세요.",
    ("쇠", 10): "정리하세요. 여유롭게 필요한 것만, 남기세요.",

    # 병
    ("병", 1): "느끼세요. 예민한 감각으로 세상을, 섬세하게 관찰하세요.",
    ("병", 2): "상상하세요. 풍부한 상상력으로 가능성을, 창의적으로 펼치세요.",
    ("병", 3): "공감하세요. 따뜻한 마음으로 타인을, 진심으로 이해하세요.",
    ("병", 4): "표현하세요. 예술적 감성으로 아름다움을, 창조하세요.",
    ("병", 5): "베푸세요. 다정한 마음으로 사랑을, 아낌없이 나누세요.",
    ("병", 6): "이동하세요. 새로운 곳으로 활기차게, 떠나보세요.",
    ("병", 7): "사색하세요. 정신적 깊이를 추구하며, 내면을 키우세요.",
    ("병", 8): "감싸세요. 따뜻한 마음으로 상처를, 부드럽게 위로하세요.",
    ("병", 9): "사유하세요. 깊이 생각하며 진리를, 찾아가세요.",
    ("병", 10): "느끼세요. 섬세한 감수성으로 세상을, 받아들이세요.",

    # 사
    ("사", 1): "마무리하세요. 깔끔하게 정리하며, 완결을 지으세요.",
    ("사", 2): "돌아보세요. 내면으로 깊이 들어가, 자신을 성찰하세요.",
    ("사", 3): "종결하세요. 담담하게 마무리하며, 새로운 준비를 시작하세요.",
    ("사", 4): "고요하세요. 평온함 속에서 내면의 소리를, 들으세요.",
    ("사", 5): "정산하세요. 차분히 정리하며 다음을, 준비하세요.",
    ("사", 6): "멈추세요. 잠시 쉬어가며 지혜를, 되새기세요.",
    ("사", 7): "비우세요. 불필요한 것을 내려놓고, 마음을 가볍게 하세요.",
    ("사", 8): "완결하세요. 의미 있게 끝을, 정리하세요.",
    ("사", 9): "내려놓으세요. 고요히 손을 떼며, 새로운 시작을 준비하세요.",
    ("사", 10): "마치세요. 마무리를 깔끔하게, 지으세요.",

    # 묘
    ("묘", 1): "품으세요. 잠재된 힘을 조용히, 내면에 키우세요.",
    ("묘", 2): "키우세요. 내면의 성장에 집중하며, 꾸준히 쌓으세요.",
    ("묘", 3): "저장하세요. 에너지를 아껴두며, 미래를 대비하세요.",
    ("묘", 4): "준비하세요. 조용히 차근차근, 준비하세요.",
    ("묘", 5): "침잠하세요. 깊이 잠기며 지혜를, 축적하세요.",
    ("묘", 6): "발견하세요. 숨겨진 가치를 천천히, 찾아내세요.",
    ("묘", 7): "축적하세요. 꾸준히 쌓아가며 기반을, 다지세요.",
    ("묘", 8): "기다리세요. 인내로 때를, 준비하세요.",
    ("묘", 9): "보존하세요. 소중한 것을 차분히, 간직하세요.",
    ("묘", 10): "품으세요. 씨앗을 조용히, 키우세요.",

    # 절
    ("절", 1): "새롭게 하세요. 마음을 깨끗이 비우고, 밝게 출발하세요.",
    ("절", 2): "결정하세요. 쿨하게 과감히, 선택하세요.",
    ("절", 3): "리셋하세요. 인생을 새롭게 정리하고, 활기차게 시작하세요.",
    ("절", 4): "정리하세요. 뒤끝 없이 깨끗하게, 마음을 비우세요.",
    ("절", 5): "기대하세요. 반전의 기운을 믿고, 희망차게 맞이하세요.",
    ("절", 6): "출발하세요. 순수한 마음으로, 밝게 나아가세요.",
    ("절", 7): "날아가세요. 자유로운 영혼으로, 활기차게 떠나세요.",
    ("절", 8): "끊으세요. 과거를 정리하고, 깔끔히 정산하세요.",
    ("절", 9): "비우세요. 고요히 집착을 내려놓고, 자유로워지세요.",
    ("절", 10): "새로 시작하세요. 과거를 끊고, 밝게 나아가세요.",

    # 태
    ("태", 1): "품으세요. 잉태의 기운으로 씨앗을, 따뜻하게 키우세요.",
    ("태", 2): "준비하세요. 시작을 신중히, 차근차근 준비하세요.",
    ("태", 3): "자라세요. 조용한 성장에 집중하며, 내실을 다지세요.",
    ("태", 4): "심으세요. 희망의 씨앗을 정성껏, 심으세요.",
    ("태", 5): "보호하세요. 소중한 것을 애정으로, 잘 지키세요.",
    ("태", 6): "기대하세요. 가능성을 밝게 믿으며, 희망을 키우세요.",
    ("태", 7): "준비하세요. 숨은 준비를 차분히, 이어가세요.",
    ("태", 8): "키우세요. 창의의 씨앗을 정성껏, 가꾸세요.",
    ("태", 9): "품으세요. 고요히 새로움을 키우며, 기다리세요.",
    ("태", 10): "잉태하세요. 희망을 조용히, 품으세요.",

    # 양
    ("양", 1): "양육하세요. 정성껏 돌보며, 성장을 도우세요.",
    ("양", 2): "키우세요. 생명력으로 가능성을, 아낌없이 키우세요.",
    ("양", 3): "지원하세요. 필요한 도움을 따뜻하게, 베푸세요.",
    ("양", 4): "가르치세요. 지혜를 나누며 성장을, 함께 이루세요.",
    ("양", 5): "발달시키세요. 꾸준한 노력으로, 성장을 이끄세요.",
    ("양", 6): "보살피세요. 세심하게 돌보며, 애정을 쏟으세요.",
    ("양", 7): "인내하세요. 꾸준히 기다리며, 성과를 이루세요.",
    ("양", 8): "돌보세요. 사랑으로 성장을, 지혜롭게 돕세요.",
    ("양", 9): "기다리세요. 고요히 성장을 지켜보며, 기다리세요.",
    ("양", 10): "완성하세요. 양육을 정성껏, 마무리하세요.",
}

fixed_text = 0
fixed_action = 0

for unsung_name, fortunes in data['운세'].items():
    for fortune in fortunes:
        # 본문 오타 수정
        if '본문' in fortune:
            original = fortune['본문']
            본문 = original

            # 으로로, 를를 등 오타
            본문 = re.sub(r'에너지으로', '에너지로', 본문)
            본문 = re.sub(r'즐겁게를', '즐겁게', 본문)
            본문 = re.sub(r'독창적으로를', '독창적으로', 본문)
            # 로로, 게를, 며로 패턴
            본문 = re.sub(r'([가-힣]+)로로', r'\1로', 본문)
            본문 = re.sub(r'([가-힣]+)게를', r'\1게', 본문)
            본문 = re.sub(r'([가-힣]+)며로', r'\1며', 본문)
            # 이(가) 패턴 - 부사/동사 뒤에 조사가 잘못 붙은 경우
            본문 = re.sub(r'([가-힣]+게)이\(가\)', r'\1', 본문)
            본문 = re.sub(r'([가-힣]+히)이\(가\)', r'\1', 본문)
            본문 = re.sub(r'([가-힣]+로)이\(가\)', r'\1', 본문)

            if 본문 != original:
                fortune['본문'] = 본문
                fixed_text += 1

        # 액션 교체
        if '액션' in fortune:
            key = (unsung_name, fortune['v'])
            if key in custom_actions:
                fortune['액션'] = custom_actions[key]
                fixed_action += 1

with open('today_unse/stories/14_병인.json', 'w', encoding='utf-8') as f:
    json.dump(data, f, ensure_ascii=False, indent=2)

print(f"{'='*60}")
print(f"✅ 14_병인.json 정성스럽게 재작성 완료!")
print(f"{'='*60}")
print(f"  본문 오타 수정: {fixed_text}개")
print(f"  액션 재작성 (본문 보완·강조): {fixed_action}개")
print(f"{'='*60}")
