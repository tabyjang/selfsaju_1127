/**
 * ============================================
 * 사주 오행 에너지 산출용 가중치 설정 (마스터 데이터)
 * ============================================
 *
 * 이 파일의 수치를 조정하여 오행 에너지 계산을 보정할 수 있습니다.
 * 각 상수는 명리학 이론에 기반하여 설정되었습니다.
 */

// ============================================
// 1. 위치별 기본 가중치 (Positional Weight)
// ============================================
// 월지를 3.0(기준)으로 하여 다른 위치의 중요도를 설정합니다.
// 일간은 분석의 주체이므로 에너지 계산에서 제외됩니다.

export const POSITION_WEIGHTS = {
  // 천간 가중치
  YEAR_STEM: 1.0,    // 연간: 조상, 먼 환경
  MONTH_STEM: 1.2,   // 월간: 청년기 운, 부모의 영향
  DAY_STEM: 1.0,     // 일간: 나 자신 (기준점, 계산에서 제외)
  HOUR_STEM: 1.1,    // 시간: 말년, 미래 진로

  // 지지 가중치
  YEAR_BRANCH: 1.0,  // 연지: 조상궁, 초년운 (가장 먼 위치)
  MONTH_BRANCH: 3.0, // 월령: 계절, 환경 (가장 강력한 영향력)
  DAY_BRANCH: 1.5,   // 일지: 배우자궁, 건강 (일간과 가장 밀접)
  HOUR_BRANCH: 1.2,  // 시지: 자식궁, 말년 결과
} as const;

// ============================================
// 2. 지장간 분해 비율 (Hidden Stem Ratio)
// ============================================
// 지지는 여러 천간의 기운이 섞여 있는 복합체입니다.
// 본기/중기/초기로 분해하여 오행 점수를 배분합니다.

export const HIDDEN_STEM_RATIO = {
  MAIN: 0.60,    // 본기: 60% (가장 강력한 주요 기운)
  MIDDLE: 0.25,  // 중기: 25% (보조 기운)
  INITIAL: 0.15, // 초기: 15% (미미한 잔여 기운)
} as const;

// ============================================
// 3. 월령 사령(當直) 가중치 (Seasonality Multiplier)
// ============================================
// 해당 계절(절입일 기준)에 태어나면 해당 오행에 추가 배율을 적용합니다.
// 예: 봄(인묘월)에 태어나면 목(木)이 사령하므로 목에 배율 적용

export const SARYEONG_MULTIPLIER = 1.5; // 사령 오행 × 1.5배

// ============================================
// 4. 통근(Rooting) 계수 (Root Coefficient)
// ============================================
// 천간이 지지에 뿌리를 내리면 에너지가 증폭됩니다.
// 통근 위치에 따라 증폭 배율이 다릅니다.

export const ROOTING_COEFFICIENT = {
  MONTH: 1.5,    // 월지에 통근: 가장 강력한 뿌리
  DAY: 1.3,      // 일지에 통근: 본인과 밀접한 뿌리
  YEAR: 1.1,     // 연지에 통근: 먼 뿌리
  HOUR: 1.1,     // 시지에 통근: 먼 뿌리
  NONE: 0.7,     // 뿌리 없음: 허상 (에너지 감소)
} as const;

// ============================================
// 5. 투간(Stem Penetration) 계수
// ============================================
// 지장간이 천간에 투출했을 때의 영향력 증폭

export const TOUGAN_MULTIPLIER = 1.3; // 투간 시 × 1.3배

// ============================================
// 6. 상호작용(합/충) 변동 배율 (Interaction Multiplier)
// ============================================
// Phase 4에서 사용할 합과 충의 영향력입니다.

export const INTERACTION_WEIGHTS = {
  // 지지 삼합 (三合)
  SAMHAP_COMPLETE: 2.0,   // 삼합 완국: 세 글자가 모두 모임 (가장 강력)
  SAMHAP_HALF: 1.5,       // 반합: 왕지 포함 2글자만 모임
  SAMHAP_WEAK: 0.3,       // 가합: 왕지 없이 2글자만 모임 (미미함)

  // 지지 방합 (方合)
  BANGHAP_COMPLETE: 2.0,  // 방합 완국: 세 글자가 모두 모임
  BANGHAP_HALF: 1.3,      // 방합 반: 2글자만 모임

  // 지지 육합 (六合)
  YUKHAP: 1.2,            // 육합: 상대적으로 약한 합

  // 천간합 (天干合)
  CHUNGAN_HAB_SUCCESS: 1.5,  // 천간합 화기 성공: 새로운 오행 생성
  CHUNGAN_HAB_TIE: 0.5,      // 천간합 기반: 서로 묶여서 작용 약화

  // 충 (沖)
  CLASH_WANGJI: 0.6,      // 왕지충 (자오, 묘유): 40% 손실
  CLASH_SAENGJI: 0.7,     // 생지충 (인신, 사해): 30% 손실
  CLASH_GOJI: 0.8,        // 고지충 (진술, 축미): 20% 손실

  // 개고 (開庫): 고지(사고)가 충을 당해 지장간이 열림
  GAEGO_BONUS: 1.2,       // 개고 시 지장간 오행 20% 가산

  // 형 (刑)
  PUNISHMENT: 0.85,       // 형살: 15% 손실
} as const;

// ============================================
// 7. 신강/신약 판정 임계값 (Strength Threshold)
// ============================================
// 신강약 지수에 따른 등급 분류 기준

export const STRENGTH_THRESHOLDS = {
  EXTREME_STRONG: 30,  // +30 이상: 태왕 (종왕격/종강격 가능)
  STRONG: 10,          // +10 ~ +30: 신강
  NEUTRAL_HIGH: 5,     // +5 ~ +10: 약간 신강
  NEUTRAL_LOW: -5,     // -5 ~ +5: 중화 (가장 이상적)
  WEAK: -30,           // -30 ~ -5: 신약
  // -30 이하: 태약 (종격 가능)
} as const;

// ============================================
// 8. 지지별 지장간 데이터 (Hidden Stems Data)
// ============================================
// 각 지지에 포함된 지장간과 그 일수 비율

export const JIJANGGAN_DATA: Record<string, {
  initial?: { stem: string; days: number };
  middle?: { stem: string; days: number };
  main: { stem: string; days: number };
}> = {
  // 왕지 (旺地): 본기가 압도적
  '子': {
    initial: { stem: '壬', days: 10 },
    main: { stem: '癸', days: 20 }
  },
  '卯': {
    initial: { stem: '甲', days: 10 },
    main: { stem: '乙', days: 20 }
  },
  '午': {
    initial: { stem: '丙', days: 10 },
    middle: { stem: '己', days: 9 },
    main: { stem: '丁', days: 11 }
  },
  '酉': {
    initial: { stem: '庚', days: 10 },
    main: { stem: '辛', days: 20 }
  },

  // 생지 (生地): 장생지로 다양한 기운
  '寅': {
    initial: { stem: '戊', days: 7 },
    middle: { stem: '丙', days: 7 },
    main: { stem: '甲', days: 16 }
  },
  '巳': {
    initial: { stem: '戊', days: 7 },
    middle: { stem: '庚', days: 7 },
    main: { stem: '丙', days: 16 }
  },
  '申': {
    initial: { stem: '戊', days: 7 },
    middle: { stem: '壬', days: 7 },
    main: { stem: '庚', days: 16 }
  },
  '亥': {
    initial: { stem: '戊', days: 7 },
    middle: { stem: '甲', days: 7 },
    main: { stem: '壬', days: 16 }
  },

  // 고지 (庫地): 토가 주가 되고 다양한 기운 저장
  '丑': {
    initial: { stem: '癸', days: 9 },
    middle: { stem: '辛', days: 3 },
    main: { stem: '己', days: 18 }
  },
  '辰': {
    initial: { stem: '乙', days: 9 },
    middle: { stem: '癸', days: 3 },
    main: { stem: '戊', days: 18 }
  },
  '未': {
    initial: { stem: '丁', days: 9 },
    middle: { stem: '乙', days: 3 },
    main: { stem: '己', days: 18 }
  },
  '戌': {
    initial: { stem: '辛', days: 9 },
    middle: { stem: '丁', days: 3 },
    main: { stem: '戊', days: 18 }
  },
} as const;

// ============================================
// 9. 천간/지지 오행 매핑
// ============================================

export const STEM_OHAENG: Record<string, 'wood' | 'fire' | 'earth' | 'metal' | 'water'> = {
  '甲': 'wood', '乙': 'wood',
  '丙': 'fire', '丁': 'fire',
  '戊': 'earth', '己': 'earth',
  '庚': 'metal', '辛': 'metal',
  '壬': 'water', '癸': 'water',
} as const;

export const BRANCH_OHAENG: Record<string, 'wood' | 'fire' | 'earth' | 'metal' | 'water'> = {
  '子': 'water',
  '丑': 'earth',
  '寅': 'wood',
  '卯': 'wood',
  '辰': 'earth',
  '巳': 'fire',
  '午': 'fire',
  '未': 'earth',
  '申': 'metal',
  '酉': 'metal',
  '戌': 'earth',
  '亥': 'water',
} as const;

// ============================================
// 10. 월지별 사령 오행 (계절별 왕성한 오행)
// ============================================
// 각 월지(계절)에서 가장 왕성한 오행

export const MONTH_SARYEONG: Record<string, 'wood' | 'fire' | 'earth' | 'metal' | 'water'> = {
  '寅': 'wood',  // 인월 (1월, 봄 시작)
  '卯': 'wood',  // 묘월 (2월, 봄 중간)
  '辰': 'earth', // 진월 (3월, 봄 끝/토왕)
  '巳': 'fire',  // 사월 (4월, 여름 시작)
  '午': 'fire',  // 오월 (5월, 여름 중간)
  '未': 'earth', // 미월 (6월, 여름 끝/토왕)
  '申': 'metal', // 신월 (7월, 가을 시작)
  '酉': 'metal', // 유월 (8월, 가을 중간)
  '戌': 'earth', // 술월 (9월, 가을 끝/토왕)
  '亥': 'water', // 해월 (10월, 겨울 시작)
  '子': 'water', // 자월 (11월, 겨울 중간)
  '丑': 'earth', // 축월 (12월, 겨울 끝/토왕)
} as const;

// ============================================
// 11. 통근 관계 정의
// ============================================
// 천간이 어느 지지에서 통근(뿌리)을 얻는지 정의

export const ROOTING_MAP: Record<string, string[]> = {
  // 양간: 해당 오행의 왕지와 생지에서 통근
  '甲': ['寅', '卯', '辰', '亥'],  // 목 양간: 인묘진해
  '丙': ['巳', '午', '未', '寅'],  // 화 양간: 사오미인
  '戊': ['辰', '戌', '丑', '未', '巳', '午'], // 토 양간: 진술축미사오
  '庚': ['申', '酉', '戌', '巳'],  // 금 양간: 신유술사
  '壬': ['亥', '子', '丑', '申'],  // 수 양간: 해자축신

  // 음간: 같은 오행 지지에서 통근
  '乙': ['卯', '寅', '辰', '未'],  // 목 음간
  '丁': ['午', '巳', '未', '戌'],  // 화 음간
  '己': ['丑', '辰', '未', '戌', '午'], // 토 음간
  '辛': ['酉', '申', '戌', '丑'],  // 금 음간
  '癸': ['子', '亥', '丑', '辰'],  // 수 음간
} as const;
