import json
import sys
import io
import re

# UTF-8 인코딩 강제 설정
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')

with open('today_unse/stories/13_병자.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# 본문 내용을 읽고 그에 맞는 액션 작성 (본문 보완·강조)
# 병자: 순수한 이상주의, 바른 원칙, 예의 바름

custom_actions = {
    # 장생
    ("장생", 1): "시작하세요. 단정하게 사람들에게 다가가, 좋은 반응을 얻으며 순수하게 즐기세요.",
    ("장생", 2): "행동하세요. 반듯한 모습으로 에너지를 전하며, 함께하고 싶은 사람이 되세요.",
    ("장생", 3): "감사하세요. 예의 바르게 다가가 받은 후원에, 순수한 감정으로 마음을 전하세요.",
    ("장생", 4): "밀어붙이세요. 바른 신념으로 솔직하게 표현하며, 응원받는 사람이 되세요.",
    ("장생", 5): "회복하세요. 맑은 마음으로 긍정 에너지를 받아들여, 빠르게 활력을 찾으세요.",
    ("장생", 6): "소통하세요. 예의 바른 모습으로 매력을 어필하며, 정직하고 자신감 있게 연결되세요.",
    ("장생", 7): "성장하세요. 밝은 비전을 믿고 꾸준히 나아가, 큰 결실을 맺으세요.",
    ("장생", 8): "떠올리세요. 이상의 씨앗을 현실로 태어나게 하며, 등불로 빛을 발하세요.",
    ("장생", 9): "심으세요. 올바른 원칙을 단단한 신념으로 자리 잡게 하며, 모범을 보이세요.",
    ("장생", 10): "내딛으세요. 순수한 이상주의로 더 나은 세상을 향해, 희망의 첫발을 떼세요.",

    # 목욕
    ("목욕", 1): "음미하세요. 예민해진 오감으로 아름다움을 경험하며, 순수하게 순간을 즐기세요.",
    ("목욕", 2): "발산하세요. 진지하게 다가가 매력을 최고조로 드러내며, 정직한 태도로 빛나세요.",
    ("목욕", 3): "시도하세요. 깨끗한 원칙으로 새로운 선택을 해, 반듯하게 신선한 자극을 받으세요.",
    ("목욕", 4): "조절하세요. 감정 기복을 순수하게 느끼되 과하지 않게, 집중력으로 균형을 잡으세요.",
    ("목욕", 5): "돌보세요. 초연한 자세로 나만의 방식으로, 진솔하게 자신에게 집중하세요.",
    ("목욕", 6): "주목하세요. 예민한 직관으로 판단해, 정확한 통찰을 얻으세요.",
    ("목욕", 7): "표현하세요. 진솔하고 우아한 언어로 생각을 전달해, 품격 있게 감탄받으세요.",
    ("목욕", 8): "빛나세요. 감정 기복을 긍정으로 바꾸며, 햇살처럼 밝게 드러내세요.",
    ("목욕", 9): "즐기세요. 화려한 순간을 품위 있게 누리며, 절제하며 빛내세요.",
    ("목욕", 10): "지키세요. 순수함을 소중히 여기며, 흔들림 없이 유지하세요.",

    # 관대
    ("관대", 1): "성장하세요. 올바른 길로 도전을 받아들이며, 한 단계씩 차근히 올라가세요.",
    ("관대", 2): "준비하세요. 계획을 꼼꼼히 세우고, 철저히 완벽하게 마무리하세요.",
    ("관대", 3): "완수하세요. 성실하게 맡은 일을 해내, 신뢰를 얻고 리더십을 발휘하세요.",
    ("관대", 4): "나누세요. 인정받는 순간을 겸손히 받아들이며, 기쁨을 나누고 더 나아가세요.",
    ("관대", 5): "자립하세요. 독립적으로 판단하고 행동해, 주도적으로 자유를 얻으세요.",
    ("관대", 6): "발휘하세요. 갈고닦은 실력을 자신 있게 보여주며, 좋은 평가를 받으세요.",
    ("관대", 7): "확립하세요. 꾸준히 노력해 자리를 확고하게 하며, 안정적 기반을 다지세요.",
    ("관대", 8): "품으세요. 반듯하게 행동하며 품격을 유지해, 올바르게 인정받으세요.",
    ("관대", 9): "승리하세요. 원칙을 끝까지 지키며, 당당히 인정받으세요.",
    ("관대", 10): "비추세요. 등불처럼 세상을 정직하게 밝히며, 빛을 발하세요.",

    # 건록
    ("건록", 1): "유지하세요. 안정을 차분히 지키며, 꾸준히 리듬을 이어가세요.",
    ("건록", 2): "발휘하세요. 실력을 정직하게 확실히 보여주며, 능력을 입증하세요.",
    ("건록", 3): "해결하세요. 스스로 해결하는 힘을 바르게 키우며, 자급자족하세요.",
    ("건록", 4): "거두세요. 근면한 노력의 결실을 당당히, 기쁘게 누리세요.",
    ("건록", 5): "균형잡으세요. 일과 휴식의 조화를 정직하게, 슬기롭게 맞춰가세요.",
    ("건록", 6): "인정받으세요. 전문성을 성실히 쌓아, 존경을 얻으세요.",
    ("건록", 7): "다지세요. 기반을 차근차근, 단단히 쌓아가세요.",
    ("건록", 8): "집중하세요. 원칙을 지키며 일에 몰입해, 내실을 다지세요.",
    ("건록", 9): "유지하세요. 바른 길을 흔들림 없이, 꿋꿋이 걸으세요.",
    ("건록", 10): "완성하세요. 성실함으로 실력을 완벽히 갖춰, 확고한 자리를 만드세요.",

    # 제왕
    ("제왕", 1): "누리세요. 최고의 순간을 겸손하게, 당당히 만끽하세요.",
    ("제왕", 2): "이끄세요. 리더십을 발휘해 사람들을, 올바르게 인도하세요.",
    ("제왕", 3): "빛나세요. 완벽한 컨디션으로 오늘을, 최선을 다해 빛내세요.",
    ("제왕", 4): "확대하세요. 영향력을 책임감 있게, 바르게 넓혀가세요.",
    ("제왕", 5): "만끽하세요. 성취를 겸손히 누리며, 기쁨을 나누세요.",
    ("제왕", 6): "드러내세요. 자신감을 정직하게, 품위 있게 표현하세요.",
    ("제왕", 7): "감동시키세요. 카리스마를 발산하며 사람들을, 진심으로 이끄세요.",
    ("제왕", 8): "실현하세요. 고결한 이상을 현실로, 의미 있게 만드세요.",
    ("제왕", 9): "주도하세요. 원칙을 지키며 상황을, 당당히 이끌어가세요.",
    ("제왕", 10): "완성하세요. 순수한 비전을 정직하게, 완벽히 이루세요.",

    # 쇠
    ("쇠", 1): "여유부리세요. 느긋한 마음으로 하루를, 평온하게 보내세요.",
    ("쇠", 2): "사색하세요. 지혜를 깊이 생각하며, 바른 길을 찾으세요.",
    ("쇠", 3): "안정하세요. 평온함을 차분히 추구하며, 중심을 잡으세요.",
    ("쇠", 4): "활용하세요. 노련한 지혜를 적절히, 올바르게 사용하세요.",
    ("쇠", 5): "챙기세요. 실속을 정직하게, 꼼꼼히 챙기세요.",
    ("쇠", 6): "지키세요. 신념을 은근히 고집하며, 흔들리지 마세요.",
    ("쇠", 7): "쉬세요. 충분히 휴식하며 몸과 마음을, 재충전하세요.",
    ("쇠", 8): "숙고하세요. 깊이 생각하며 원칙을, 되새기세요.",
    ("쇠", 9): "유지하세요. 평온함 속에서 안정을, 꾸준히 지키세요.",
    ("쇠", 10): "정리하세요. 여유롭게 필요한 것만, 바르게 남기세요.",

    # 병
    ("병", 1): "느끼세요. 예민한 감각으로 세상을, 섬세하게 관찰하세요.",
    ("병", 2): "상상하세요. 풍부한 상상력으로 가능성을, 순수하게 펼치세요.",
    ("병", 3): "공감하세요. 따뜻한 마음으로 타인을, 진심으로 이해하세요.",
    ("병", 4): "표현하세요. 예술적 감성으로 아름다움을, 정성껏 창조하세요.",
    ("병", 5): "베푸세요. 다정한 마음으로 사랑을, 아낌없이 나누세요.",
    ("병", 6): "이동하세요. 새로운 곳으로 용기 내어, 자유롭게 떠나보세요.",
    ("병", 7): "사색하세요. 정신적 깊이를 추구하며, 내면을 키우세요.",
    ("병", 8): "감싸세요. 따뜻한 마음으로 상처를, 부드럽게 위로하세요.",
    ("병", 9): "사유하세요. 깊이 생각하며 진리를, 순수하게 찾으세요.",
    ("병", 10): "느끼세요. 섬세한 감수성으로 세상을, 받아들이세요.",

    # 사
    ("사", 1): "마무리하세요. 깔끔하게 정리하며, 완결을 지으세요.",
    ("사", 2): "돌아보세요. 내면으로 깊이 들어가, 자신을 성찰하세요.",
    ("사", 3): "종결하세요. 담담하게 마무리하며, 새로운 준비를 시작하세요.",
    ("사", 4): "고요하세요. 평온함 속에서 내면의 소리를, 들으세요.",
    ("사", 5): "정산하세요. 차분히 정리하며 다음을, 준비하세요.",
    ("사", 6): "멈추세요. 잠시 쉬어가며 원칙을, 되새기세요.",
    ("사", 7): "비우세요. 불필요한 것을 내려놓고, 마음을 정리하세요.",
    ("사", 8): "완결하세요. 원칙을 지키며 끝을, 의미 있게 맺으세요.",
    ("사", 9): "내려놓으세요. 고요히 손을 떼며, 새로운 시작을 준비하세요.",
    ("사", 10): "마치세요. 정직하게 마무리를, 깔끔하게 지으세요.",

    # 묘
    ("묘", 1): "품으세요. 잠재된 힘을 조용히, 내면에 키우세요.",
    ("묘", 2): "키우세요. 내면의 성장에 집중하며, 꾸준히 쌓으세요.",
    ("묘", 3): "저장하세요. 에너지를 아껴두며, 미래를 대비하세요.",
    ("묘", 4): "준비하세요. 조용히 차근차근, 정직하게 준비하세요.",
    ("묘", 5): "침잠하세요. 깊이 잠기며 지혜를, 차분히 쌓으세요.",
    ("묘", 6): "발견하세요. 숨겨진 가치를 천천히, 찾아내세요.",
    ("묘", 7): "축적하세요. 꾸준히 쌓아가며 기반을, 단단히 다지세요.",
    ("묘", 8): "기다리세요. 인내로 때를, 고요히 준비하세요.",
    ("묘", 9): "보존하세요. 소중한 것을 차분히, 잘 간직하세요.",
    ("묘", 10): "품으세요. 원칙의 씨앗을, 조용히 키우세요.",

    # 절
    ("절", 1): "새롭게 하세요. 마음을 깨끗이 비우고, 산뜻하게 출발하세요.",
    ("절", 2): "결정하세요. 쿨하게 과감히, 선택하세요.",
    ("절", 3): "리셋하세요. 인생을 새롭게 정리하고, 다시 시작하세요.",
    ("절", 4): "정리하세요. 뒤끝 없이 깨끗하게, 마음을 비우세요.",
    ("절", 5): "기대하세요. 반전의 기운을 믿고, 새로운 시작을 맞이하세요.",
    ("절", 6): "출발하세요. 순수한 마음으로, 처음처럼 나아가세요.",
    ("절", 7): "날아가세요. 자유로운 영혼으로, 구애 없이 떠나세요.",
    ("절", 8): "끊으세요. 과거를 정리하고, 깔끔히 정산하세요.",
    ("절", 9): "비우세요. 고요히 집착을 내려놓고, 자유로워지세요.",
    ("절", 10): "새로 시작하세요. 과거를 끊고 바른 길로, 다시 나아가세요.",

    # 태
    ("태", 1): "품으세요. 잉태의 기운으로 씨앗을, 따뜻하게 키우세요.",
    ("태", 2): "준비하세요. 시작을 신중히, 차근차근 준비하세요.",
    ("태", 3): "자라세요. 조용한 성장에 집중하며, 내실을 다지세요.",
    ("태", 4): "심으세요. 좋은 씨앗을 정성껏, 미래에 심으세요.",
    ("태", 5): "보호하세요. 소중한 것을 애정으로, 잘 지키세요.",
    ("태", 6): "기대하세요. 가능성을 믿으며, 희망을 키우세요.",
    ("태", 7): "준비하세요. 숨은 준비를 차분히, 꾸준히 이어가세요.",
    ("태", 8): "키우세요. 이상의 씨앗을 정성껏, 조용히 가꾸세요.",
    ("태", 9): "품으세요. 고요히 새로움을 키우며, 기다리세요.",
    ("태", 10): "잉태하세요. 순수한 이상을, 조용히 품으세요.",

    # 양
    ("양", 1): "양육하세요. 정성껏 돌보며, 성장을 도우세요.",
    ("양", 2): "키우세요. 성장의 기운으로 가능성을, 아낌없이 키우세요.",
    ("양", 3): "지원하세요. 필요한 도움을, 아낌없이 베푸세요.",
    ("양", 4): "가르치세요. 지혜를 나누며 성장을, 함께 이루세요.",
    ("양", 5): "발달시키세요. 꾸준한 노력으로, 성장을 이끄세요.",
    ("양", 6): "보살피세요. 세심하게 돌보며, 애정을 쏟으세요.",
    ("양", 7): "인내하세요. 꾸준히 기다리며, 성과를 이루세요.",
    ("양", 8): "돌보세요. 사랑으로 성장을, 지혜롭게 돕세요.",
    ("양", 9): "기다리세요. 고요히 성장을 지켜보며, 기다리세요.",
    ("양", 10): "완성하세요. 양육을 정성껏, 온전히 마무리하세요.",
}

fixed_text = 0
fixed_action = 0

for unsung_name, fortunes in data['운세'].items():
    for fortune in fortunes:
        # 본문 오타 수정
        if '본문' in fortune:
            original = fortune['본문']
            본문 = original

            # 로로 패턴
            본문 = re.sub(r'([가-힣]+)로로', r'\1로', 본문)
            # ~게를, ~히를 패턴
            본문 = re.sub(r'([가-힣]+게)를\s', r'\1 ', 본문)
            본문 = re.sub(r'([가-힣]+히)를\s', r'\1 ', 본문)

            if 본문 != original:
                fortune['본문'] = 본문
                fixed_text += 1

        # 액션 교체
        if '액션' in fortune:
            key = (unsung_name, fortune['v'])
            if key in custom_actions:
                fortune['액션'] = custom_actions[key]
                fixed_action += 1

with open('today_unse/stories/13_병자.json', 'w', encoding='utf-8') as f:
    json.dump(data, f, ensure_ascii=False, indent=2)

print(f"{'='*60}")
print(f"✅ 13_병자.json 정성스럽게 재작성 완료!")
print(f"{'='*60}")
print(f"  본문 오타 수정: {fixed_text}개")
print(f"  액션 재작성 (본문 보완·강조): {fixed_action}개")
print(f"{'='*60}")
